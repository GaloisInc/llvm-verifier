include "SHA2.cry";

extern AIG sha384_gcrypt("sha384.aig") : [4][8] -> [384];

sha384_gcrypt_fixed msg = join (reverse(bytes))
  where {
      bytes : [48][8];
      bytes = split (sha384_gcrypt(msg));
  };

theorem sha_eq: {msg}.
  sha384 (msg : [3][8]) == sha384_gcrypt_fixed (msg # [0]);
