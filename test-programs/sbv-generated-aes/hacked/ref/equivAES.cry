include "Cipher.cry";

extern AIG llvm_aes("../aes.aig") : ([4][32], [4][32]) -> [4][32];

blockEncryptref : ([128], [128]) -> [128];
blockEncryptref (x, y) = blockEncrypt (x, y)
  where {
    include "Rijndael.cry";
  };

blockEncryptref_c : ([4][32], [4][32]) -> [4][32];
blockEncryptref_c (x, y) = reverse (split (blockEncrypt (join y', join x')))
  where {
    x' = reverse x;
    y' = reverse y;
    include "Rijndael.cry";
  };

include "AES.cry";
